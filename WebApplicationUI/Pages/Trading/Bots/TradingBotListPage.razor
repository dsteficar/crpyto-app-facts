@page "/trade-bots/list"

@using System.Security.Claims
@using Application.DTOs.TradeBots.Responses
@using WebApplicationUI.Services.TradingBots

@inject ITradingBotClientService TradingBotClientService
@inject NavigationManager NavigationManager
@inject AuthenticationStateProvider AuthenticationStateProvider

<PageTitle>Trade Bots</PageTitle>

<div class="container">
    <h3>My Trade Bots</h3>

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h5>Trade Bots Management</h5>
        <RadzenButton Text="New Trade Bot" Icon="add" ButtonStyle="ButtonStyle.Primary" Click="CreateNewTradeBot" />
    </div>

    <RadzenDataList AllowVirtualization="true" Style="height:80vh;overflow:auto;"
                    Data="@tradeBots" Count="@totalCount" TItem="GetUserTradeBotResponseDTO" PageSize="5"
                    IsLoading="@isLoading" LoadData="@LoadTradeBots"
                    ShowPagingSummary="true" PagerHorizontalAlign="HorizontalAlign.Left">
        <Template Context="bot">
            <RadzenCard Variant="Variant.Outlined" class="rz-p-0" Style="width: 100%; overflow: hidden;">
                <RadzenRow Gap="0">
                    <RadzenColumn Size="12" SizeLG="3" class="rz-p-4 product-title">
                        <RadzenText TextStyle="TextStyle.H6" TagName="TagName.H5" class="rz-color-on-secondary-lighter">
                            @(bot.Name)
                        </RadzenText>
                    </RadzenColumn>
                    <RadzenColumn Size="12" SizeLG="7" class="rz-p-4">
                        <RadzenRow Gap="0">
                            <RadzenColumn Size="12" SizeMD="6" SizeLG="2">
                                <RadzenText TextStyle="TextStyle.H6" TagName="TagName.H5" class="rz-mb-0">Enabled</RadzenText>
                                <RadzenText TextStyle="TextStyle.Body2">@((bot.IsEnabled ? "Yes" : "No"))</RadzenText>
                            </RadzenColumn>
                        </RadzenRow>
                    </RadzenColumn>
                    <RadzenColumn Size="12" SizeLG="2" class="rz-p-4">
                        <RadzenButton Text="Edit" Click="@(() => EditTradeBot(bot.Id))" />
                        <RadzenButton Text="Delete" ButtonStyle="ButtonStyle.Danger" Click="@(() => DeleteTradeBot(bot.Id))" />
                    </RadzenColumn>
                </RadzenRow>
            </RadzenCard>
        </Template>
    </RadzenDataList>
</div>
