@page "/parallel-channel-management"

@using Application.Contracts.Services
@using AutoMapper
@using Microsoft.AspNetCore.Components.Web
@using Radzen.Blazor
@using WebAdminUI.Models.ParallelChannels
@using WebAdminUI.Services.ParallelChannels

@inject IParallelChannelService ParallelChannelService
@inject IMapper Mapper;

@attribute [StreamRendering]

@rendermode InteractiveServer

<script src="_content/Radzen.Blazor/Radzen.Blazor.js"></script>
<link href="css/main.css" rel="stylesheet">

<PageTitle>Parallel Channel Management</PageTitle>

<h3 style="color: white; font-size: 16px;">Users</h3>

<div class="rz-header-container">

    <RadzenCard Variant="Variant.Outlined" class="rz-header-edit-mode rz-my-4" Style="background: #111212">
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
            <RadzenButton ButtonStyle="ButtonStyle.Success" Icon="add_circle" Text="Add new user" Click="@InsertRow" Disabled="@(editMode == DataGridEditMode.Single && parallelChannelsToInsert.Count() > 0)" />
            <div>Edit Mode:</div>
            <RadzenSelectBar @bind-Value="@editMode" TextProperty="Text" ValueProperty="Value"
                             Data="@(Enum.GetValues(typeof(DataGridEditMode)).Cast<DataGridEditMode>().Select(t => new { Text = $"{t}", Value = t }))" Size="ButtonSize.Small"
                             Disabled="@(editMode == DataGridEditMode.Multiple && parallelChannelsToInsert.Count() > 1)" />
        </RadzenStack>
    </RadzenCard>
</div>


<RadzenDataGrid @ref="parallelChannelGrid" AllowAlternatingRows="false" AllowFiltering="true" AllowPaging="true" PageSize="10" AllowSorting="true" EditMode="@editMode"
                Data="@parallelChannels" TItem="ParallelChannelDataGridAdminModel" RowUpdate="@OnUpdateRow" RowCreate="@OnCreateRow" Sort="@Reset" Page="@Reset" Filter="@Reset" ColumnWidth="200px">
    <Columns>
        <RadzenDataGridColumn Property="Id" Title="ID" Width="5%" TextAlign="TextAlign.Left" Frozen="true" />
        <RadzenDataGridColumn Property="@nameof(ParallelChannelDataGridAdminModel.UserId)" Title="User ID" Width="10%">
            <EditTemplate Context="parallelChannel">
                <RadzenNumeric @bind-Value="parallelChannel.UserId" Style="width: 100%; display: block" Name="Point1" aria-label="Enter the user id" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="@nameof(ParallelChannelDataGridAdminModel.Price1)" Title="Price #1" Width="15%">
            <EditTemplate Context="parallelChannel">
                <RadzenNumeric @bind-Value="parallelChannel.Price1" Style="width: 100%; display: block" Name="Point1" aria-label="Enter the first price point" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="@nameof(ParallelChannelDataGridAdminModel.Timestamp1)" Title="Timestamp #1" Width="15%">
            <EditTemplate Context="parallelChannel">
                <RadzenNumeric @bind-Value="parallelChannel.Timestamp1" Style="width: 100%; display: block" Name="Timestamp1" aria-label="Enter the first timestamp point" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="@nameof(ParallelChannelDataGridAdminModel.Price2)" Title="Price #2" Width="15%">
            <EditTemplate Context="parallelChannel">
                <RadzenNumeric @bind-Value="parallelChannel.Price2" Style="width: 100%; display: block" Name="Price2" aria-label="Enter the second price point" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="@nameof(ParallelChannelDataGridAdminModel.Timestamp2)" Title="Timestamp #2" Width="15%">
            <EditTemplate Context="parallelChannel">
                <RadzenNumeric @bind-Value="parallelChannel.Timestamp2" Style="width: 100%; display: block" Name="Timestamp2" aria-label="Enter the second timestamp point" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="@nameof(ParallelChannelDataGridAdminModel.Price3)" Title="Price #3" Width="15%">
            <EditTemplate Context="parallelChannel">
                <RadzenNumeric @bind-Value="parallelChannel.Price3" Style="width: 100%; display: block" Name="Point1" aria-label="Enter the third price point" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Property="@nameof(ParallelChannelDataGridAdminModel.Timestamp3)" Title="Timestamp #3" Width="15%">
            <EditTemplate Context="parallelChannel">
                <RadzenNumeric @bind-Value="parallelChannel.Timestamp3" Style="width: 100%; display: block" Name="Point1" aria-label="Enter the third timestamp point" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Context="parallelChannel" Filterable="false" Sortable="false" Width="10%" TextAlign="TextAlign.Right">
            <Template Context="parallelChannel">
                <RadzenButton Icon="edit" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium" Click="@(args => EditRow(parallelChannel))" @onclick:stopPropagation="true">
                </RadzenButton>
                <RadzenButton ButtonStyle="ButtonStyle.Danger" Icon="delete" Variant="Variant.Flat" Shade="Shade.Lighter" Size="ButtonSize.Medium" class="rz-my-1 rz-ms-1" Click="@(args => DeleteRow(parallelChannel))" @onclick:stopPropagation="true">
                </RadzenButton>
            </Template>
            <EditTemplate Context="parallelChannel">
                <RadzenButton Icon="check" ButtonStyle="ButtonStyle.Success" Variant="Variant.Flat" Size="ButtonSize.Medium" Click="@((args) => SaveRow(parallelChannel))" aria-label="Save">
                </RadzenButton>
                <RadzenButton Icon="close" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium" class="rz-my-1 rz-ms-1" Click="@((args) => CancelEdit(parallelChannel))" aria-label="Cancel">
                </RadzenButton>
                <RadzenButton ButtonStyle="ButtonStyle.Danger" Icon="delete" Variant="Variant.Flat" Shade="Shade.Lighter" Size="ButtonSize.Medium" class="rz-my-1 rz-ms-1" Click="@(args => DeleteRow(parallelChannel))" aria-label="Delete">
                </RadzenButton>
            </EditTemplate>
        </RadzenDataGridColumn>
    </Columns>
</RadzenDataGrid>
